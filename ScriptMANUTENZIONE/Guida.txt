ğŸš€ Guida completa installazione e configurazione
0) Aggiorna il sistema e imposta il fuso orario
sudo apt-get update && sudo apt-get upgrade -y
sudo timedatectl set-timezone Europe/Rome

1) Installa i pacchetti necessari
sudo apt-get install -y screen tar pigz mariadb-server mariadb-client

2) Configura MariaDB (max_connections permanente)
Apri il file di configurazione:
sudo nano /etc/mysql/mariadb.conf.d/50-server.cnf


Cerca la sezione [mysqld] e aggiungi/aggiorna cosÃ¬:
[mysqld]
max_connections = 500


Salva ed esci. Poi riavvia MariaDB:
sudo systemctl restart mariadb


Verifica (Dovresti vedere 500):
mysql -u root -p -e "SHOW VARIABLES LIKE 'max_connections';"


3) Configura le credenziali per i backup
Crea /root/.my.cnf:
sudo nano /root/.my.cnf


Contenuto (modifica user/password):
[client]
user=root
password=LA_TUA_PASSWORD
host=localhost


Proteggi il file:
sudo chmod 600 /root/.my.cnf

4) Crea cartelle di backup
sudo mkdir -p /home/backup/server
sudo mkdir -p /home/backup/database

5) Script di manutenzione (mc_maintenance.sh)
Percorso:
sudo nano /usr/local/bin/mc_maintenance.sh

[INCOLLA IL FILE: "mc_maintenance.sh" che trovi sotto allegato]


Permessi:
sudo chmod +x /usr/local/bin/mc_maintenance.sh

6) Script di avvio screen (mc_start_screens.sh)
Percorso:
sudo nano /usr/local/bin/mc_start_screens.sh

[INCOLLA IL FILE: "mc_start_screens.sh" che trovi sotto allegato]

Permessi:
sudo chmod +x /usr/local/bin/mc_start_screens.sh

7) Servizio systemd per avvio screen
sudo nano /etc/systemd/system/mc-screens.service


Contenuto:
[Unit]
Description=Start Minecraft screens after boot
After=network-online.target mariadb.service
Wants=network-online.target

[Service]
Type=oneshot
ExecStart=/usr/local/bin/mc_start_screens.sh
RemainAfterExit=yes
User=root

[Install]
WantedBy=multi-user.target


Abilita:
sudo systemctl daemon-reload
sudo systemctl enable mc-screens.service

8) Cron per manutenzione notturna
sudo crontab -e


Aggiungi:
25 4 * * * /usr/local/bin/mc_maintenance.sh warn5 >> /var/log/mc_maintenance.log 2>&1
28 4 * * * /usr/local/bin/mc_maintenance.sh warn2 >> /var/log/mc_maintenance.log 2>&1
30 4 * * * /usr/local/bin/mc_maintenance.sh maintain >> /var/log/mc_maintenance.log 2>&1

9) Verifiche

Stato servizio:
systemctl status mc-screens.service


Lista screen:
screen -list


Backup:
/home/backup/server/imperiumDD-MM-YYYY.tar.gz
/home/backup/database/impdataDDMMYYYY.sql.gz

PER FAR SI CHE I PLUGIN SI AGGIORNINO IN AUTOMATICO:
sudo apt update && sudo apt install jq

Crea la cartella che serve per gli update locali:
mkdir /home/pluginupdate


ğŸ”¹ 1. Test parziale (avvisi)
Puoi lanciare solo i messaggi di avviso nei tuoi screen:

sudo /usr/local/bin/mc_maintenance.sh warn5
sudo /usr/local/bin/mc_maintenance.sh warn2


CosÃ¬ verifichi che i messaggi arrivino in game.

ğŸ”¹ 2. Test completo (manutenzione)

Questo avvierÃ  tutta la sequenza whitelist â†’ kickall â†’ stop â†’ backup â†’ update â†’ reboot.
âš ï¸ Attenzione: al termine la macchina si riavvia davvero.
sudo /usr/local/bin/mc_maintenance.sh maintain